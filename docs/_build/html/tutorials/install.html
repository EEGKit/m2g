

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Install &mdash; ndmg 0.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Function Reference" href="funcref.html" />
    <link rel="prev" title="ndmg" href="../index.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> ndmg
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#system-requirements">System Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation-guide">Installation Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#docker">Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pip">Pip</a></li>
<li class="toctree-l3"><a class="reference internal" href="#github">Github</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="funcref.html">Function Reference</a></li>
</ul>
<p class="caption"><span class="caption-text">Pipeline Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../pipeline/diffusion.html">Diffusion Pipeline</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/diffusion.html#output-summary-table">Output Summary Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/diffusion.html#output-subject-level-pipeline-summary">Output subject-level pipeline summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/diffusion.html#registration">Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/diffusion.html#tensor-estimation">Tensor Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/diffusion.html#tractography">Tractography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline/diffusion.html#graph-estimation">Graph Estimation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pipeline/functional.html">Functional Pipeline</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ndmg</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Install</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/tutorials/install.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="install">
<h1><a class="toc-backref" href="#id1">Install</a><a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#install" id="id1">Install</a><ul>
<li><a class="reference internal" href="#summary" id="id2">Summary</a></li>
<li><a class="reference internal" href="#system-requirements" id="id3">System Requirements</a></li>
<li><a class="reference internal" href="#installation-guide" id="id4">Installation Guide</a><ul>
<li><a class="reference internal" href="#docker" id="id5">Docker</a></li>
<li><a class="reference internal" href="#pip" id="id6">Pip</a></li>
<li><a class="reference internal" href="#github" id="id7">Github</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id2">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Pull docker container:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">pull</span> <span class="n">neurodata</span><span class="o">/</span><span class="n">m3r</span><span class="o">-</span><span class="n">release</span><span class="p">:</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">1</span>
</pre></div>
</div>
<p>Run dmri participant pipeline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">ti</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;/</span><span class="n">path</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">inputs</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;/</span><span class="n">path</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">out</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">outputs</span> <span class="n">neurodata</span><span class="o">/</span><span class="n">m3r</span><span class="o">-</span><span class="n">release</span><span class="p">:</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">1</span> <span class="o">/</span><span class="n">inputs</span> <span class="o">/</span><span class="n">outputs</span> <span class="n">participant</span> <span class="n">dwi</span> <span class="o">--</span><span class="n">nproc</span> <span class="o">&lt;</span><span class="n">ncores</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="system-requirements">
<h2><a class="toc-backref" href="#id3">System Requirements</a><a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h2>
<p>The ndmg pipeline:</p>
<ul>
<li><p class="first">was developed and tested primarily on Mac OSX, Ubuntu (12, 14, 16), and CentOS (5, 6);</p>
</li>
<li><p class="first">was developed in Python 2.7;</p>
</li>
<li><p class="first">is wrapped in a Docker container;</p>
</li>
<li><p class="first">has install instructions via a Dockerfile;</p>
</li>
<li><p class="first">requires no non-standard hardware to run;</p>
</li>
<li><p class="first">has key features built upon FSL, Dipy, Nibabel, Nilearn, Networkx, Numpy, Scipy, Scikit-Learn, and others;</p>
</li>
<li><p class="first">takes approximately 1-core, 8-GB of RAM, and 1 hour to run for most datasets.</p>
</li>
<li><p class="first">While ndmg is quite robust to Python package versions (with only few exceptions, mentioned in the installation guide), an example of possible versions (taken from the ndmg Docker Image with version v0.0.50) is shown below. Note: this list excludes many libraries which are standard with a Python distribution, and a complete list with all packages and versions can be produced by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">freeze</span></code> within the Docker container mentioned above.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awscli</span><span class="o">==</span><span class="mf">1.11</span><span class="o">.</span><span class="mi">128</span> <span class="p">,</span> <span class="n">boto3</span><span class="o">==</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">5</span> <span class="p">,</span> <span class="n">botocore</span><span class="o">==</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">91</span> <span class="p">,</span> <span class="n">colorama</span><span class="o">==</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">7</span> <span class="p">,</span> <span class="n">dipy</span><span class="o">==</span><span class="mf">0.12</span><span class="o">.</span><span class="mi">0</span> <span class="p">,</span> <span class="n">matplotlib</span><span class="o">==</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">1</span> <span class="p">,</span>
<span class="n">networkx</span><span class="o">==</span><span class="mf">1.11</span> <span class="p">,</span> <span class="n">nibabel</span><span class="o">==</span><span class="mf">2.1</span><span class="o">.</span><span class="mi">0</span> <span class="p">,</span> <span class="n">nilearn</span><span class="o">==</span><span class="mf">0.3</span><span class="o">.</span><span class="mi">1</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">==</span><span class="mf">1.8</span><span class="o">.</span><span class="mi">2</span> <span class="p">,</span> <span class="n">Pillow</span><span class="o">==</span><span class="mf">2.3</span><span class="o">.</span><span class="mi">0</span> <span class="p">,</span> <span class="n">plotly</span><span class="o">==</span><span class="mf">1.12</span><span class="o">.</span><span class="mi">9</span> <span class="p">,</span>
<span class="n">s3transfer</span><span class="o">==</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">10</span> <span class="p">,</span> <span class="n">scikit</span><span class="o">-</span><span class="n">image</span><span class="o">==</span><span class="mf">0.13</span><span class="o">.</span><span class="mi">0</span> <span class="p">,</span> <span class="n">scikit</span><span class="o">-</span><span class="n">learn</span><span class="o">==</span><span class="mf">0.18</span><span class="o">.</span><span class="mi">2</span> <span class="p">,</span> <span class="n">scipy</span><span class="o">==</span><span class="mf">0.13</span><span class="o">.</span><span class="mi">3</span> <span class="o">.</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="installation-guide">
<h2><a class="toc-backref" href="#id4">Installation Guide</a><a class="headerlink" href="#installation-guide" title="Permalink to this headline">¶</a></h2>
<p>Currently, the Docker image is recommended.</p>
<p><code class="docutils literal notranslate"><span class="pre">pip</span></code> and Github installations are also available.</p>
<div class="section" id="docker">
<h3><a class="toc-backref" href="#id5">Docker</a><a class="headerlink" href="#docker" title="Permalink to this headline">¶</a></h3>
<p>The neurodata/m3r-release Docker container enables users to run end-to-end connectome estimation on structural MRI or functional MRI right from container launch. The pipeline requires that data be organized in accordance with the BIDS spec. If the data you wish to process is available on S3 you simply need to provide your s3 credentials at build time and the pipeline will auto-retrieve your data for processing.</p>
<p>If you have never used Docker before, it is useful to run through the Docker <a class="reference external" href="https://docs.docker.com/">documentation</a>.</p>
<p><strong>Getting Docker container</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker pull neurodata/m3r-release
</pre></div>
</div>
<p><em>(A) I do not wish to use S3:</em></p>
<p>You are good to go!</p>
<p><em>(B) I wish to use S3:</em></p>
<p>Add your secret key/access id to a file called credentials.csv in this directory on your local machine. A dummy file has been provided to make the format we expect clear. (This is how AWS provides credentials)</p>
<p><strong>Processing Data</strong></p>
<p>Below is the help output generated by running <strong>ndmg</strong> with the <code class="docutils literal notranslate"><span class="pre">-h</span></code> command. All parameters are explained in this output.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ docker run -ti neurodata/m3r-release -h

usage: ndmg_bids [-h]
                [--participant_label PARTICIPANT_LABEL [PARTICIPANT_LABEL ...]]
                [--session_label SESSION_LABEL [SESSION_LABEL ...]]
                [--task_label TASK_LABEL [TASK_LABEL ...]]
                [--run_label RUN_LABEL [RUN_LABEL ...]] [--bucket BUCKET]
                [--remote_path REMOTE_PATH] [--push_data] [--dataset DATASET]
                [--atlas ATLAS] [--minimal] [--hemispheres] [--log] [--debug]
                [--bg BG] [--nthreads NTHREADS] [--stc STC]

This is an end-to-end connectome estimation pipeline from M3r images

positional arguments:
bids_dir              The directory with the input dataset formatted
                        according to the BIDS standard.
output_dir            The directory where the output files should be stored.
                        If you are running group level analysis this folder
                        should be prepopulated with the results of the
                        participant level analysis.
{participant,group}   Level of the analysis that will be performed. Multiple
                        participant level analyses can be run independently
                        (in parallel) using the same output_dir.
{dwi,func}            Modality of MRI scans that are being evaluated.

optional arguments:
-h, --help            show this help message and exit
--participant_label PARTICIPANT_LABEL [PARTICIPANT_LABEL ...]
                        The label(s) of the participant(s) that should be
                        analyzed. The label corresponds to
                        sub-&lt;participant_label&gt; from the BIDS spec (so it does
                        not include &quot;sub-&quot;). If this parameter is not provided
                        all subjects should be analyzed. Multiple participants
                        can be specified with a space separated list.
--session_label SESSION_LABEL [SESSION_LABEL ...]
                        The label(s) of the session that should be analyzed.
                        The label corresponds to ses-&lt;participant_label&gt; from
                        the BIDS spec (so it does not include &quot;ses-&quot;). If this
                        parameter is not provided all sessions should be
                        analyzed. Multiple sessions can be specified with a
                        space separated list.
--task_label TASK_LABEL [TASK_LABEL ...]
                        The label(s) of the task that should be analyzed. The
                        label corresponds to task-&lt;task_label&gt; from the BIDS
                        spec (so it does not include &quot;task-&quot;). If this
                        parameter is not provided all tasks should be
                        analyzed. Multiple tasks can be specified with a space
                        separated list.
--run_label RUN_LABEL [RUN_LABEL ...]
                        The label(s) of the run that should be analyzed. The
                        label corresponds to run-&lt;run_label&gt; from the BIDS
                        spec (so it does not include &quot;task-&quot;). If this
                        parameter is not provided all runs should be analyzed.
                        Multiple runs can be specified with a space separated
                        list.
--bucket BUCKET       The name of an S3 bucket which holds BIDS organized
                        data. You must have built your bucket with credentials
                        to the S3 bucket you wish to access.
--remote_path REMOTE_PATH
                        The path to the data on your S3 bucket. The data will
                        be downloaded to the provided bids_dir on your
                        machine.
--push_data           flag to push derivatives back up to S3.
--dataset DATASET     The name of the dataset you are perfoming QC on.
--atlas ATLAS         The atlas being analyzed in QC (if you only want one).
--minimal             Determines whether to show a minimal or full set of
                        plots.
--hemispheres         Whether or not to break degrees into hemispheres or
                        not
--log                 Determines axis scale for plotting.
--debug               flag to store temp files along the path of processing.
--bg BG               Whether to produce big graphs.
--nthreads NTHREADS   The number of threads you have available. Should be
                        approximately min(ncpu*hyperthreads/cpu, maxram/10).
--stc STC             A file for slice timing correction. Options are a TR
                        sequence file (where each line is the shift in TRs),
                        up (ie, bottom to top), down (ie, top to bottom), and
                        interleaved.
</pre></div>
</div>
<p>In order to share data between our container and the rest of our machine in Docker, we need to mount a volume. Docker does this with the -v flag. Docker expects its input formatted as: <code class="docutils literal notranslate"><span class="pre">-v</span> <span class="pre">path/to/local/data:/path/in/container</span></code>. We’ll do this when we launch our container, as well as give it a helpful name so we can locate it later on.</p>
<p><strong>To run ndmg on data</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">docker</span> <span class="n">run</span> <span class="o">-</span><span class="n">ti</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;/</span><span class="n">path</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">inputs</span> <span class="o">-</span><span class="n">v</span> <span class="o">&lt;/</span><span class="n">path</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">out</span><span class="o">&gt;</span><span class="p">:</span><span class="o">/</span><span class="n">outputs</span> <span class="n">neurodata</span><span class="o">/</span><span class="n">m3r</span><span class="o">-</span><span class="n">release</span><span class="p">:</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">1</span> <span class="o">/</span><span class="n">inputs</span> <span class="o">/</span><span class="n">outputs</span> <span class="n">participant</span> <span class="n">dwi</span>
</pre></div>
</div>
<p>If you have a computer with multiple cores, using the <code class="docutils literal notranslate"><span class="pre">--nproc</span></code> flag is highly recommended for parallel processing.</p>
</div>
<div class="section" id="pip">
<h3><a class="toc-backref" href="#id6">Pip</a><a class="headerlink" href="#pip" title="Permalink to this headline">¶</a></h3>
<p>ndmg relies on FSL, Dipy, networkx, and nibabel, numpy scipy, scikit-learn, scikit-image, nilearn. You should install FSL through the instructions on their website, then follow install other Python dependencies with the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">ndmg</span>
</pre></div>
</div>
<p>The only known packages which require a specific version are plotly and networkx, due to backwards-compatability breaking changes.</p>
<p>Installation shouldn’t take more than a few minutes, but depends on your internet connection.</p>
</div>
<div class="section" id="github">
<h3><a class="toc-backref" href="#id7">Github</a><a class="headerlink" href="#github" title="Permalink to this headline">¶</a></h3>
<p>To install directly from Github, run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">neurodata</span><span class="o">/</span><span class="n">ndmg</span>
<span class="n">cd</span> <span class="n">ndmg</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="funcref.html" class="btn btn-neutral float-right" title="Function Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral" title="ndmg" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Gregory Kiar, Eric Bridgeford

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>